<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Run() Module Method | ServerHub References</title>
    <meta name="description" content="Fast and reliable MVC framework for Nodejs">
    <link rel="icon" href="/favicon.png">
  <link rel="manifest" href="/manifest.json">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:500,400,300|Roboto+Mono">
  <link rel="stylesheet" href="//fonts.googleapis.com/earlyaccess/notosansscsliced.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  <script src="https://www.googletagmanager.com/gtag/js?id=UA-122724564-2" async="true"></script>
  <script src="/assets/inject.js" async="true"></script>
  <script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());

gtag('config', 'UA-122724564-2');</script>
    
    <link rel="preload" href="/assets/css/0.styles.b028f09f.css" as="style"><link rel="preload" href="/assets/js/app.1dd38295.js" as="script"><link rel="preload" href="/assets/js/15.ba1ba006.js" as="script"><link rel="prefetch" href="/assets/js/17.4e4c6ca5.js"><link rel="prefetch" href="/assets/js/2.54d91119.js"><link rel="prefetch" href="/assets/js/3.e3815ec9.js"><link rel="prefetch" href="/assets/js/4.b4bbe4df.js"><link rel="prefetch" href="/assets/js/5.ba8ae864.js"><link rel="prefetch" href="/assets/js/6.a5c16cdb.js"><link rel="prefetch" href="/assets/js/7.7c8bdfdf.js"><link rel="prefetch" href="/assets/js/8.14434d8a.js"><link rel="prefetch" href="/assets/js/9.b7b13cdb.js"><link rel="prefetch" href="/assets/js/10.ff6be549.js"><link rel="prefetch" href="/assets/js/11.48a539f4.js"><link rel="prefetch" href="/assets/js/12.45b463a5.js"><link rel="prefetch" href="/assets/js/13.1300dbff.js"><link rel="prefetch" href="/assets/js/14.c4afc325.js"><link rel="prefetch" href="/assets/js/16.3ba8b27f.js"><link rel="prefetch" href="/assets/js/18.1c87f19d.js"><link rel="prefetch" href="/assets/js/19.4d0f19bb.js"><link rel="prefetch" href="/assets/js/20.cd6dced5.js"><link rel="prefetch" href="/assets/js/21.a3a63f2b.js"><link rel="prefetch" href="/assets/js/22.1194f43a.js"><link rel="prefetch" href="/assets/js/23.a00289aa.js"><link rel="prefetch" href="/assets/js/24.1ac289f3.js"><link rel="prefetch" href="/assets/js/25.dc6e9a8a.js"><link rel="prefetch" href="/assets/js/26.67142004.js"><link rel="prefetch" href="/assets/js/27.7a506074.js"><link rel="prefetch" href="/assets/js/28.b3c35da4.js"><link rel="prefetch" href="/assets/js/29.0049cb67.js"><link rel="prefetch" href="/assets/js/30.892df537.js"><link rel="prefetch" href="/assets/js/31.5c0cd29b.js"><link rel="prefetch" href="/assets/js/32.2a374046.js"><link rel="prefetch" href="/assets/js/33.090937bb.js"><link rel="prefetch" href="/assets/js/34.4d223979.js"><link rel="prefetch" href="/assets/js/35.6e99ed1c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b028f09f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/" class="home-link router-link-active"><!----><span class="site-name">
      ServerHub References
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><a href="/tutorial/" class="nav-link">Tutorial</a></div><div class="nav-item"><a href="/document/" class="nav-link router-link-active">Document</a></div><div class="nav-item"><a href="/about/" class="nav-link">About</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Languages</span><span class="arrow right"></span></a><ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----><a href="/document/run-module-method.html" class="nav-link router-link-exact-active router-link-active">English</a></li><li class="dropdown-item"><!----><a href="/zh/document/run-module-method.html" class="nav-link">简体中文</a></li></ul></div></div><a href="https://github.com/ServerHubOrg/serverhub-mvc" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/tutorial/" class="nav-link">Tutorial</a></div><div class="nav-item"><a href="/document/" class="nav-link router-link-active">Document</a></div><div class="nav-item"><a href="/about/" class="nav-link">About</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Languages</span><span class="arrow right"></span></a><ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----><a href="/document/run-module-method.html" class="nav-link router-link-exact-active router-link-active">English</a></li><li class="dropdown-item"><!----><a href="/zh/document/run-module-method.html" class="nav-link">简体中文</a></li></ul></div></div><a href="https://github.com/ServerHubOrg/serverhub-mvc" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav><ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>Document</span><!----></p><ul class="sidebar-group-items"><li><a href="/document/" class="sidebar-link">Document</a></li><li><a href="/document/run-module-method.html" class="active sidebar-link">Run() Module Method</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/document/run-module-method.html#serverhub-run" class="sidebar-link">ServerHub.Run()</a></li><li class="sidebar-sub-header"><a href="/document/run-module-method.html#instance-run-configuration" class="sidebar-link">Instance.Run() Configuration</a></li><li class="sidebar-sub-header"><a href="/document/run-module-method.html#return-value-v1-6-0" class="sidebar-link">Return Value v1.6.0</a></li></ul></li><li><a href="/document/controller.html" class="sidebar-link">Controllers</a></li><li><a href="/document/route.html" class="sidebar-link">Route</a></li><li><a href="/document/plugin.html" class="sidebar-link">Plugin</a></li><li><a href="/document/database.html" class="sidebar-link">Database</a></li><li><a href="/document/middleware.html" class="sidebar-link">Middleware</a></li><li><a href="/document/archive.html" class="sidebar-link">Archives</a></li></ul></div></li></ul></div><div class="page"><div class="content"><h1 id="run-module-method"><a href="#run-module-method" aria-hidden="true" class="header-anchor">#</a> Run() Module Method</h1><h2 id="serverhub-run"><a href="#serverhub-run" aria-hidden="true" class="header-anchor">#</a> ServerHub.Run()</h2><p><a href="/tutorial/getting-started.html#usage">View this</a>. This chapter includes brief introduction of ServerHub instance Run() method.</p><h2 id="instance-run-configuration"><a href="#instance-run-configuration" aria-hidden="true" class="header-anchor">#</a> Instance.Run() Configuration</h2><p>The other day, I introduced <code>instance.Run()</code> method to you. And in this chapter, we will talk about the first parameter of <code>instance.Run()</code> method - the configuration object.</p><h3 id="as-simple-as-possible"><a href="#as-simple-as-possible" aria-hidden="true" class="header-anchor">#</a> As simple as possible</h3><p>Not like what we've seen in <a href="/tutorial/getting-started.html#usage">Usage</a> chapter, the configuraton object is much too complicated. And in fact, there is only one property that is required: <code>BaseDir</code>.</p><p><code>BaseDir</code> is the root path of server, which will be used during the whole life circle of your ServerHub application. If your current entry file, such as <code>app.js</code>, is just located in the directory that you want to use as server root. Then the value should be <code>__dirname</code>, which is a global variable of Node.js.</p><p>This is the simplest configuration that can make ServerHub work functional normally.</p><h3 id="other-properties"><a href="#other-properties" aria-hidden="true" class="header-anchor">#</a> Other properties</h3><p>To customize ServerHub, you need some extra configurations.</p><h4 id="webdir"><a href="#webdir" aria-hidden="true" class="header-anchor">#</a> WebDir</h4><p><code>WebDir</code> is website directory. Your page files, contents, scripts and assets should be put in this directory. ServerHub uses &quot;www/&quot; as its default value. If you want to set up a new website root directory, create a folder and pass its name to <code>WebDir</code> property.</p><h4 id="controllerdir"><a href="#controllerdir" aria-hidden="true" class="header-anchor">#</a> ControllerDir</h4><p>We all know that ServerHub routes request to controllers. If we want them to be registered, we have to provide the contain directory name to ServerHub. The path of controller directory should be relative to server root path. If you don't specify one, the default value will be &quot;controller/&quot;.</p><h4 id="controllers"><a href="#controllers" aria-hidden="true" class="header-anchor">#</a> Controllers</h4><p>Sometimes, we don't want to register every controller in the contain folder. Then we can pass an array of required controller file name to this parameter. eg: <code>['home.js', 'data.js']</code>. But if you want all controller files to be registered, just ignore <code>Controllers</code> property and ServerHub will automatically scan and register every file under <code>ControllerDir</code>.</p><h4 id="viewdir-and-modeldir"><a href="#viewdir-and-modeldir" aria-hidden="true" class="header-anchor">#</a> ViewDir and ModelDir</h4><p>Pretty similar to <code>ControllerDir</code> in previous section. They are used to hold view files and models.</p><h4 id="dbprovider"><a href="#dbprovider" aria-hidden="true" class="header-anchor">#</a> DBProvider</h4><p>Specify your database provider. In current version, ServerHub only supports MySQL, which means the only valid value would be &quot;mysql&quot;.</p><h4 id="dbconnectionstring"><a href="#dbconnectionstring" aria-hidden="true" class="header-anchor">#</a> DBConnectionString</h4><p>If you have only one database instance to connect, the suggested way is to pass a global database connection string to ServerHub. Because if you don't, you will have to provide a value every time you call <code>GetConnection()</code> method on your database provider.</p><h4 id="maxcachesize"><a href="#maxcachesize" aria-hidden="true" class="header-anchor">#</a> MaxCacheSize</h4><p>This specifies how much memory can ServerHub caching system allocate. If file sizes exceeded this limit, then ServerHub will call WCS to unload some unnecessary caches. This will be covered in later chapters.</p><h4 id="defaultpages"><a href="#defaultpages" aria-hidden="true" class="header-anchor">#</a> DefaultPages</h4><p>ServerHub uses a fallback strategy for default pages. And your default page file must be put under the root of <code>WebDir</code> directory. In default, ServerHub uses &quot;index.html&quot; first, then &quot;default.html&quot; and finally &quot;page.html&quot;. You can override this configuration by passing an array like <code>['hello.html', 'first.html']</code> to this property.</p><h4 id="pagenotfound-v0-0-93"><a href="#pagenotfound-v0-0-93" aria-hidden="true" class="header-anchor">#</a> PageNotFound <code>v0.0.93+</code></h4><p>When the request does not match any resources or route rules, ServerHub will render an error page to the response. From v0.0.93, you can add your custom error page to ServerHub server directory and specify with this property.</p><p>More property definitions are coming soon.</p><h4 id="asyncoperationtimeout-v0-0-97"><a href="#asyncoperationtimeout-v0-0-97" aria-hidden="true" class="header-anchor">#</a> AsyncOperationTimeout <code>v0.0.97+</code></h4><p>In <code>v0.0.96</code>, we introduced <code>this.Runtime.WAIT</code> signal to be the workaroud for some time consuming asynchronous operations, such as database query etc. But you should know this signal is pretty dangrous. What if you <code>forget</code> to set false to it or the operation takes too much time and dead before callback? So, ServerHub has to count down as a backup operation if it cost too much time. The default value is 10 seconds. If you want it to be shorter or longer, just pass the value to the configuration parameter.(Unit: <strong>milliseconds</strong>)</p><h4 id="tlsoption-v1-0-6"><a href="#tlsoption-v1-0-6" aria-hidden="true" class="header-anchor">#</a> TLSOption <code>v1.0.6+</code></h4><p>Since <code>v1.0.6</code>, ServerHub enhanced security with TLS/SSL. You may secure the connection with a <code>TLSOption</code> property. This property has four sub-properties: <code>Key: string, Cert: string, CA: string</code>x and <code>Port: Array&lt;string&gt;|Array&lt;number&gt;|number|string</code>. You need to load your private key and certificate files and assign their values to the properties above. And most importantly, you need to specify the port you want to secure.</p><p>Here is a <a href="/tutorial/tls-tutorial.html">tutorial</a> help you with TLS in ServerHub MVC.</p><h4 id="socketoptions-v1-6-0"><a href="#socketoptions-v1-6-0" aria-hidden="true" class="header-anchor">#</a> SocketOptions <code>v1.6.0</code></h4><p>Since <code>v1.6.0</code>, ServerHub introduced WebSocket support to the main repository. This enhanced the ability of ServerHub-mvc supporting real-time applications such as online chat room. Generally, you may use WebSocket listeners on multiple ports, even TLS ones.</p><p>On client side, you just use:</p><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">new</span> <span class="token class-name">WebSocket</span><span class="token punctuation">(</span><span class="token string">'ws://hostname:port/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token class-name">WebSocket</span><span class="token punctuation">(</span><span class="token string">'wss://hostname:port/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// TLS</span>
</code></pre></div><p>There are 2 properties:</p><ul><li><code>Port</code> this can be a single number or an array of numbers. It must be the subset of the <code>Port</code> property of the major configuration object.</li><li><code>ConnectionCallback</code> is a callback function. It receives a <a href="https://github.com/websockets/ws" target="_blank" rel="noopener noreferrer">WebSocket<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> object as its parameter.</li></ul><p>TLS support note. As ServerHub supported TLS since <code>v1.0.6</code>, developers may benefit from a self-signed certificate while debuging locally. But this is not gonna work in WebSocket. Your browser may refuse to connect if your authority is not valid.</p><h2 id="return-value-v1-6-0"><a href="#return-value-v1-6-0" aria-hidden="true" class="header-anchor">#</a> Return Value <code>v1.6.0</code></h2><p>This method returns an object with two properties.</p><ul><li><code>Servers</code> Array (Server - HTTP/HTTPS server)</li><li><code>Sockets</code> Array (Server - WebSocket server)</li></ul><p><code>Servers</code> are the all the servers that started and listening on the ports you specified. <code>Sockets</code> are the WebSocket servers that you attached the exact ports.</p></div><div class="page-edit"><div class="edit-link"><a href="https://github.com/ServerHubOrg/serverhub-docs/edit/dev/docs/document/run-module-method.md" target="_blank" rel="noopener noreferrer">Edit this page on Github</a><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div><!----></div><div class="page-nav"><p class="inner"><span class="prev"><i class="material-icons">arrow_back</i><a href="/document/" class="prev router-link-active">
          Document
        </a></span><span class="next"><a href="/document/controller.html">
          Controllers
        </a><i class="material-icons">arrow_forward</i></span></p></div></div></div></div>
    <script src="/assets/js/15.ba1ba006.js" defer></script><script src="/assets/js/app.1dd38295.js" defer></script>
  </body>
</html>
