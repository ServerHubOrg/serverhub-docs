(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{179:function(t,e,s){"use strict";s.r(e);var a=s(0),n=Object(a.a)({},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"content"},[t._m(0),t._m(1),s("p",[t._v("Controllers are very important and extremely basic. Routed path will dispatch actions defined in each controller. In this article, we will discuss about controller composing and other essential parts you need to notice.")]),t._m(2),t._m(3),t._m(4),t._m(5),t._m(6),t._m(7),t._m(8),s("p",[t._v("If you modify any controller files while ServerHub running, check if your browser will show you the latest modifications. There will be no effect when you refresh the web pages. ServerHub loads and registers controllers when the application first starts. And it will never automatically update these files. Not like views and models, ServerHub always cache and renew cached content for them. So that ServerHub can be both fast and stable.")]),s("p",[t._v("So, never try to change controller files during ServerHub running.")]),t._m(9),t._m(10),t._m(11),t._m(12),t._m(13),t._m(14),t._m(15),s("p",[t._v("Actions are methods that been invoked when the HTTP request matches a certain route path. And it handles the request and operates on the response. In this chapter, we will discuss about actions in controller and help you learn more about ServerHub controllers.")]),t._m(16),t._m(17),s("p",[t._v("See, this is a very simple 'index' action. You need to declare the action as a function member of an object and return the object as the controller instance. One more thing, as we've mentioned a lot, you should always use 'this' pointer while referencing controller scope variables.")]),t._m(18),t._m(19),s("p",[t._v("will only output 'Hello, XWZ' and the return value of 'index' action gonna be ignored.")]),t._m(20),t._m(21),s("p",[t._v("Action names are all written in lower cases. Characters from 'a' to 'z', with numbers and '_' (underscore) are allowed. There are several reserved action names that you cannot use: Runtime, System, Console, View.")]),s("p",[t._v("The best practice are using single words as action names, and verbs are prefered. An action name with more 20 characters are pretty bad. And you should know that in later versions of ServerHub, maybe there will be an limitation of action name length, which might not run functional normally with your old-fashioned code.")]),t._m(22),t._m(23),t._m(24),t._m(25),t._m(26),t._m(27),t._m(28),s("p",[t._v("Now, it is an absolute JavaScript file.")]),t._m(29),t._m(30),s("p",[t._v('As you can see, there is a redundant pair of function braces that should be removed. And this is why we call ServerHub controllers "partial JavaScript files".')]),s("hr"),t._m(31),s("p",[t._v("Database is probably the next thing you really want to handle with after you set up the basic of the website. And ServerHub supports some of the most popular databases.")]),t._m(32),t._m(33),s("p",[t._v("Let's begin with an example (MySQL):")]),t._m(34),s("p",[t._v("This is a classic controller script file with 'index' action. Inside the action method, you can see how easily you can interact with MySQL database.")]),t._m(35),s("p",[t._v("Basically, there are two steps:")]),t._m(36),s("p",[t._v("Now, you can handle with MySQL database.")]),t._m(37),s("p",[t._v("Since ServerHub MVC v1.0.3 imported module syntax, you now have the ability to import/require your favorite packages/modules to build a stronger application. You may not need ServerHub's way of accessing databases, but you are always suggested to controller scope variables due to a better integration.")]),s("hr"),t._m(38),t._m(39),s("p",[t._v("As ServerHub is the foundation of a web server, if you start everything from scratch, then you have to handle with plenty of very basic operations. Just because ServerHub automatically route requests to the corresponding handlers (controllers or static cache), you cannot operate on everything seperately. How about doing something right before routing? Like authentication or filtering. And how about doing something after routing? Like triggering a statistic listener that help you analysis system performance.")]),s("p",[t._v('Here, we introduce "plugin" to you. Instructions in this document is pretty simple, but don\'t miss the chance to build your own plugin!')]),t._m(40),s("p",[t._v('Let\'s see a picture first. (Tips: right click on the image and choose "open image in new tab" to view high definition image)')]),t._m(41),t._m(42),t._m(43),s("p",[t._v("Before-route plugins usually do not care about where will the request be sent to with route. It can do some global operations like authentication. After-route plugins usually concentrate on one specific kind of different request types. Some receive requests for controllers while others focus on handling cache-able static resources.")]),t._m(44),s("p",[t._v("A plugin is exactly a Node.js module. It has to obey all the rules for Node.js modules. But here are some limits:")]),t._m(45),t._m(46),t._m(47),t._m(48),s("hr"),t._m(49),t._m(50),t._m(51),t._m(52),t._m(53),t._m(54),t._m(55),s("p",[t._v("Here we have some examples (assuming that you have home controller with index/info actions in your project):")]),t._m(56),s("p",[t._v("Request paths that does not match the route rule will be treated as requests to static resources.")]),s("p",[t._v("But how to set positive rule? Look at this:")]),t._m(57),t._m(58),t._m(59),t._m(60),t._m(61),s("p",[t._v("Here are three examples:")]),t._m(62),t._m(63),t._m(64),s("p",[t._v("One thing that you should know about string negative route rule is: your rules should always start with '/'.")]),t._m(65),s("p",[t._v('What if want to ignore all routes that start with "no-route"? Should we write every possibilities? Of course, that is not possible. So we use the regular expression above to ignore all request with prefix "no-route" (upper-case or lower-case)')]),t._m(66),t._m(67),t._m(68),t._m(69),s("p",[t._v("According to "),s("a",{attrs:{href:"https://tools.ietf.org/html/rfc1738",target:"_blank",rel:"noopener noreferrer"}},[t._v("RFC 1738"),s("OutboundLink")],1),t._v(", a valid search in URL is defined as follows:")]),t._m(70),s("p",[t._v("More specificly, ServerHub allows:")]),t._m(71),s("p",[t._v('Please always obey the above rules, later versions of ServerHub might eable "strict mode" to force ignore search/query with invalid characters.')]),s("hr"),t._m(72),t._m(73),s("p",[s("router-link",{attrs:{to:"/tutorial/getting-started.html#usage"}},[t._v("View this")]),t._v(". This chapter includes brief introduction of ServerHub instance Run() method.")],1),t._m(74),t._m(75),t._m(76),s("p",[t._v("Not like what we've seen in "),s("router-link",{attrs:{to:"/tutorial/getting-started.html#usage"}},[t._v("Usage")]),t._v(" chapter, the configuraton object is much too complicated. And in fact, there is only one property that is required: "),s("code",[t._v("BaseDir")]),t._v(".")],1),t._m(77),s("p",[t._v("This is the simplest configuration that can make ServerHub work functional normally.")]),t._m(78),s("p",[t._v("To customize ServerHub, you need some extra configurations.")]),t._m(79),t._m(80),t._m(81),s("p",[t._v('We all know that ServerHub routes request to controllers. If we want them to be registered, we have to provide the contain directory name to ServerHub. The path of controller directory should be relative to server root path. If you don\'t specify one, the default value will be "controller/".')]),t._m(82),t._m(83),t._m(84),t._m(85),t._m(86),s("p",[t._v('Specify your database provider. In current version, ServerHub only supports MySQL, which means the only valid value would be "mysql".')]),t._m(87),t._m(88),t._m(89),s("p",[t._v("This specifies how much memory can ServerHub caching system allocate. If file sizes exceeded this limit, then ServerHub will call WCS to unload some unnecessary caches. This will be covered in later chapters.")]),t._m(90),t._m(91),t._m(92),s("p",[t._v("When the request does not match any resources or route rules, ServerHub will render an error page to the response. From v0.0.93, you can add your custom error page to ServerHub server directory and specify with this property.")]),s("p",[t._v("More property definitions are coming soon.")]),t._m(93),t._m(94),t._m(95),t._m(96),s("p",[t._v("Here is a "),s("router-link",{attrs:{to:"/tutorial/tls-tutorial.html"}},[t._v("tutorial")]),t._v(" help you with TLS in ServerHub MVC.")],1)])},[function(){var t=this.$createElement,e=this._self._c||t;return e("h1",{attrs:{id:"serverhub-mvc-1-3-0-docs"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#serverhub-mvc-1-3-0-docs","aria-hidden":"true"}},[this._v("#")]),this._v(" ServerHub-MVC 1.3.0 Docs")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"controllers"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#controllers","aria-hidden":"true"}},[this._v("#")]),this._v(" Controllers")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"controller-composing"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#controller-composing","aria-hidden":"true"}},[this._v("#")]),this._v(" Controller Composing")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Here is a good example of "),e("code",[this._v("home.js")]),this._v(" custom controller:")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{attrs:{class:"token string"}},[t._v('"use strict"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  index"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("function")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" method"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("this")]),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("View")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  primary"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("function")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" method"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" context "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("this")]),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("View")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    context"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v('"Ziyuan"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" context"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Controller files are plain but special JavaScript files. you must return an object providing "),e("strong",[this._v("action functions")]),this._v(" to ServerHub. So when ServerHub dispatching after routing, your custom controller actions can be invoked.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("There are three primary paramters of a controller action method: "),e("em",[this._v("request")]),this._v(", "),e("em",[this._v("response")]),this._v(" and "),e("em",[this._v("method")]),this._v(". They are all required.")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ul",[s("li",[s("strong",[s("em",[t._v("request")])]),t._v(" refers to the "),s("em",[t._v("IncomingMessage")]),t._v(" of Node.js.")]),s("li",[s("strong",[s("em",[t._v("response")])]),t._v(" refers to the "),s("em",[t._v("ServerResponse")]),t._v(" object of the request.")]),s("li",[s("strong",[s("em",[t._v("method")])]),t._v(" is a string and can be the following: GET, POST, PATCH, UPDATE, DELETE and PUT.")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"compile-time-and-static-controllers"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#compile-time-and-static-controllers","aria-hidden":"true"}},[this._v("#")]),this._v(" Compile-time and Static Controllers")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"controller-scope-variables"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#controller-scope-variables","aria-hidden":"true"}},[this._v("#")]),this._v(" Controller Scope Variables")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("There are several variables that can be accessed inside controller actions. In order to use them, you must explicitly use pointer "),e("strong",[e("em",[this._v("this")])]),this._v(" as a reference to the controller instance. Or, there will be an error message displayed.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("You are suggested to use "),e("strong",[this._v("arrow functions")]),this._v(" that accessible since ECMAScript 2015. Or, you may use some workaround to access to those variables (closure or something else).")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"complete-list-of-supported-controller-scope-variables"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#complete-list-of-supported-controller-scope-variables","aria-hidden":"true"}},[this._v("#")]),this._v(" Complete list of supported controller scope variables")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Usage of these variables are avaliable at "),e("code",[this._v("doc/variables/{VariableName}.md")]),this._v(". Some variables that have primitive types like "),e("code",[this._v("string")]),this._v(", "),e("code",[this._v("number")]),this._v(" etc. (as well as some reference to vanilla Node.js implementation) will not be doced, FYI.")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ul",[s("li",[s("p",[s("code",[t._v("this.View()")]),s("strong",[s("em",[t._v("Function")])]),t._v(" Returns the corresponding model file.")])]),s("li",[s("p",[s("code",[t._v("this.Runtime")]),s("strong",[s("em",[t._v("Object")])]),t._v(" Contains bunch of other runtime features.")]),s("ol",[s("li",[s("code",[t._v("this.Runtime.DBProvider")]),s("strong",[s("em",[t._v("Object")])]),t._v(" A reference to initialized database provider instanced (default MySQL).")]),s("li",[s("code",[t._v("this.Runtime.FileHelper")]),s("strong",[s("em",[t._v("Object")])]),t._v(" A reference to FileHelper object.")]),s("li",[s("code",[t._v("this.Runtime.WAIT")]),s("strong",[s("em",[t._v("boolean")])]),t._v(" Force to hold connection until asynchronous operations done.")])])]),s("li",[s("p",[s("code",[t._v("this.System")]),s("strong",[s("em",[t._v("Object")])]),t._v(" Provide bunch of readonly constants inside ServerHub instance.")]),s("ol",[s("li",[s("code",[t._v("this.System.Version")]),s("strong",[s("em",[t._v("string")])]),t._v(" ServerHub version.")]),s("li",[s("code",[t._v("this.System.NodeVersion")]),s("strong",[s("em",[t._v("string")])]),t._v(" Node.js version.")]),s("li",[s("code",[t._v("this.System.Platform")]),s("strong",[s("em",[t._v("string")])]),t._v(" Platform information (win32, linux, etc.).")]),s("li",[s("code",[t._v("this.System.Hardware")]),s("strong",[s("em",[t._v("Object")])]),t._v(" Bunch of information about hardware.\n"),s("ul",[s("li",[s("code",[t._v("this.System.Hardware.TotalMemory")]),s("strong",[s("em",[t._v("number")])]),t._v(" Installed memory size (byte).")]),s("li",[s("code",[t._v("this.System.Hardware.FreeMemory")]),s("strong",[s("em",[t._v("number")])]),t._v(" Free memory size (byte).")]),s("li",[s("code",[t._v("this.System.Hardware.NetworkInterfaces")]),s("strong",[s("em",[t._v("Object")])]),t._v(" Returns interfaces that have been assigned a network address.")])])]),s("li",[s("code",[t._v("this.System.Die(exit_code)")]),s("strong",[s("em",[t._v("Function")])]),t._v(" Exit current ServerHub process.")])])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"actions-in-controller"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#actions-in-controller","aria-hidden":"true"}},[this._v("#")]),this._v(" Actions in Controller")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"how-to-compose-an-action"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#how-to-compose-an-action","aria-hidden":"true"}},[this._v("#")]),this._v(" How to compose an action")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("index"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" response"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" method"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{attrs:{class:"token comment"}},[t._v("// do something")]),t._v("\n    "),s("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("this")]),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("View")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("There are three parameters and they are all required. If you want to manually control server response by calling methods like "),e("code",[this._v("res.write()")]),this._v(", then ServerHub will ignore default render process, which means:")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("index"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" response"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" method"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    response"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("write")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v("'Hello, XWZ'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("this")]),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("View")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",[t._v("The "),s("code",[t._v("request")]),t._v(" parameter is the vanilla Node.js request (aka "),s("code",[t._v("IncomingMessage")]),t._v(" object) (at version 0.0.7). But the "),s("code",[t._v("response")]),t._v(" parameter is a virtual "),s("code",[t._v("ServerResponse")]),t._v(" object. Several methods and properties are wrapped on that object, which are not exactly the same as the original one. Read the document before invoking. "),s("code",[t._v("Method")]),t._v(" is a string that tells the current HTTP method (like GET, POST, etc).")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"action-name-convention"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#action-name-convention","aria-hidden":"true"}},[this._v("#")]),this._v(" Action name convention")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"about-syntax"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#about-syntax","aria-hidden":"true"}},[this._v("#")]),this._v(" About Syntax")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("If you use some lint tools, ServerHub's controller file may report syntax errors. It could tell that \""),e("em",[this._v("return statement outside function")]),this._v('". But actually they are valid '),e("strong",[this._v("partial")]),this._v(" JavaScript files.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Controllers scripts are all "),e("strong",[this._v("functions")]),this._v(", they are not independent JavaScript files. When you try to execute controller files directly, it is not gonna work.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Here is an example. We have a controller file like this ("),e("code",[this._v("home.js")]),this._v("):")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{attrs:{class:"token string"}},[t._v('"use strict"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  index"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("function")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" method"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("this")]),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("View")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("If you treat this "),e("code",[this._v("home.js")]),this._v(" as a plain JavaScript file, there should be curly braces surrounding the return statement. Check this:")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{attrs:{class:"token string"}},[t._v('"use strict"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        index"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("function")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" method"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("this")]),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("View")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("strong",[this._v("But, do you remember that our controllers are all "),e("em",[this._v("functions")])]),this._v("? What does this mean? Your whole controller file is a function, and it has invisible boundries which are curly braces. So, if we manually add function definition to controller file, the loaded controller will be like:")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{attrs:{class:"token string"}},[t._v('"use strict"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            index"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("function")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" method"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),s("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("this")]),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("View")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"database"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#database","aria-hidden":"true"}},[this._v("#")]),this._v(" Database")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("In this very first beta version of ServerHub, you can interact with MySQL (default) extremely easily with the controller scope variable: "),e("code",[this._v("this.Runtime.DBProvider")]),this._v(".")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"an-easy-to-use-example"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#an-easy-to-use-example","aria-hidden":"true"}},[this._v("#")]),this._v(" An Easy-to-use Example")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{attrs:{class:"token string"}},[t._v('"use strict"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nmodule"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    index"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" method"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{attrs:{class:"token keyword"}},[t._v("let")]),t._v(" db "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("this")]),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Runtime"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DBProvider"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{attrs:{class:"token keyword"}},[t._v("let")]),t._v(" conn "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" db"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("GetConnection")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            Host"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v('"localhost"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            Username"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v('"devchache"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            Password"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v('"ziyuan"')]),t._v("\n        "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        conn"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("connect")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err "),s("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" err"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{attrs:{class:"token keyword"}},[t._v("this")]),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Console"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("log")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v('"Connected!"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),s("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("this")]),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("View")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"two-steps-of-connecting-to-mysql"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#two-steps-of-connecting-to-mysql","aria-hidden":"true"}},[this._v("#")]),this._v(" Two Steps of Connecting to MySQL")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ol",[s("li",[t._v("Get database provider object from "),s("code",[t._v("this.Runtime.DBProvider")]),t._v(". Don't forget to use "),s("code",[t._v("this")]),t._v(" reference.")]),s("li",[t._v("Get database connection with "),s("code",[t._v("db.GetConnection()")]),t._v(" method. If you have already set up the configuration for database connection strings (in your entry file, like "),s("code",[t._v("app.js")]),t._v("), there are no required parameters. But if not, you must provide three parameters: "),s("code",[t._v("Host")]),t._v(", "),s("code",[t._v("Username")]),t._v(" and "),s("code",[t._v("Password")]),t._v(" (No need to explain more, hah?).")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"a-more-common-way"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#a-more-common-way","aria-hidden":"true"}},[this._v("#")]),this._v(" A More Common Way")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"plugin"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#plugin","aria-hidden":"true"}},[this._v("#")]),this._v(" Plugin")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"tip custom-block"},[e("p",{staticClass:"custom-block-title"},[this._v("TIP")]),e("p",[this._v("avaliable since v1.0.0-beta")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"plugin-hooks"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#plugin-hooks","aria-hidden":"true"}},[this._v("#")]),this._v(" Plugin hooks")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:"/assets/serverhub-module-plugin-sequence.png",alt:"plugin"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("So, when an HTTP request enters ServerHub, it will be handled with ServerHub core module. Then the first phase of plugins will be activated. After all of them successfully go through the data, ServerHub will call route functions to generate a corresponding "),e("code",[this._v("RouteResult")]),this._v(", which contains information about how the request should be handled (where, who). Next, the other phase of plugins will be activated to operate on the data.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("The two phase of plugins are "),e("strong",[this._v("before-route")]),this._v(" plugin and "),e("strong",[this._v("after-route")]),this._v(" plugin.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"how-to-compose-a-plugin"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#how-to-compose-a-plugin","aria-hidden":"true"}},[this._v("#")]),this._v(" How to compose a plugin")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ul",[s("li",[s("p",[t._v("A valid plugin must have at least the following properties:")]),s("ul",[s("li",[s("code",[t._v("app_name")]),t._v(" A unique name for your plugin. All the letters must be in lower cases. Valid ones include alphanumeric characters and single dashes, eg: serverhub-plugin-my-filter (the serverhub-plugin- prefix is required).")]),s("li",[s("code",[t._v("version")]),t._v(" Version tag for your plugin. Suggested to follow NPM custom.")]),s("li",[s("code",[t._v("version_support")]),t._v(" Indicates the least version of ServerHub to run the plugin.")]),s("li",[s("code",[t._v("phase")]),t._v(" Whether this is a after-route or before-route plugin.")]),s("li",[s("code",[t._v("main")]),t._v(" Entry function for your plugin. For before-route plugins, 2 parameters are required; for after-route plugins, 3 parameters are requried.")])])]),s("li",[s("p",[t._v("Here is an example")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("module"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  app_name"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v('"serverhub-plugin-my-plugin"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  version"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v('"0.1.0"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  version_support"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v('"1.0.0-alpha"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  phase"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v('"before-route"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  main"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("function")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("log")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v('"Hello, this is my first ServerHub plugin!"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"important-things-to-remember"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#important-things-to-remember","aria-hidden":"true"}},[this._v("#")]),this._v(" Important things to remember")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"warning custom-block"},[e("p",{staticClass:"custom-block-title"},[this._v("Keep this in mind:")]),e("p",[e("strong",[this._v("NEVER try to modify response parameter passing to your plugin "),e("code",[this._v("main")]),this._v(" function!")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"route"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#route","aria-hidden":"true"}},[this._v("#")]),this._v(" Route")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Route is one of ServerHub's core features. With route, all HTTP request can be filtered and send to correct handlers. For example, "),e("code",[this._v("/index.html")]),this._v(" might be a static webpage, but "),e("code",[this._v("/home/index")]),this._v(" could be a controller URL. ServerHub's route system provide two ways to deal with it. One is called positive rules and the other one is called negative rules.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"positive-rules"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#positive-rules","aria-hidden":"true"}},[this._v("#")]),this._v(" Positive rules")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Positive rules looks like JavaScript string formatting. There are several '{' and '}' symbols in the rule content. Between each pair of parenthess lies the segment name of rule syntax. Valid segment names are: controller, action and id. For example: "),e("code",[this._v('"api/{controller}/{action}/{id}"')]),this._v(".")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Prefix "),e("code",[this._v("api")]),this._v(" is a normal string. Every request that matches the rule should start with this prefix.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("code",[this._v("controller")]),this._v(" is the name of controller, which is right the name of the controller file.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("code",[this._v("action")]),this._v(" is the function property defined in controller scripts.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("Valid request path:\n  /api/home/index\n  /api/home/info/\n  /api/home/index/5\n  /api/home/index/5?name=xu_wangzhe\n  /api/home/index/?name=xu_wangzhe\n\nInvalid request path:\n  /home/index\n  /api/home/index.html\n  /api/home/5\n  /api/index/5?name=xu_wangzhe\n  /api/home-foo/index/?name=xu_wangzhe\n")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("route "),s("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  route"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("MapRoute")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v('"default"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v('"v1/{controller}/{action}/{id}"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Pass this annoymous function as the second parameter of "),e("code",[this._v("instance.Run()")]),this._v(" method.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"negative-rules"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#negative-rules","aria-hidden":"true"}},[this._v("#")]),this._v(" Negative rules")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("strong",[this._v("Negative rules are checked ahead of any positive rules")]),this._v(". If any request path matched any negative rule, it will immediately be treated as static resources.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Negative rules support "),e("strong",[this._v("both")]),this._v(" string rule definition and regular expressions. An array is used to contain all the rules needed.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"string-rule-example"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#string-rule-example","aria-hidden":"true"}},[this._v("#")]),this._v(" String rule example")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("route"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("IgnoreRoute")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{attrs:{class:"token string"}},[t._v('"/language/all"')]),s("span",{attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",[t._v("As you can see. The "),s("code",[t._v("language")]),t._v(" controller may have "),s("code",[t._v("english")]),t._v(" and "),s("code",[t._v("chinese")]),t._v(" actions, but "),s("code",[t._v("all")]),t._v(" is not an action. If we don't ignore this route, ServerHub will try to seek for action named "),s("code",[t._v("all")]),t._v(", which will fire an exception. So, we use this string rule to ignore specific request path.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"regular-expression-example"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#regular-expression-example","aria-hidden":"true"}},[this._v("#")]),this._v(" Regular expression example")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("route"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("IgnoreRoute")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{attrs:{class:"token regex"}},[t._v("/^\\/no-route.*$/i")]),s("span",{attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"multiple-negative-rules"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#multiple-negative-rules","aria-hidden":"true"}},[this._v("#")]),this._v(" Multiple negative rules")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("route"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("IgnoreRoute")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{attrs:{class:"token string"}},[t._v('"/language/all"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{attrs:{class:"token regex"}},[t._v("/^\\/no-route.*$/i")]),s("span",{attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"search-query-in-url"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#search-query-in-url","aria-hidden":"true"}},[this._v("#")]),this._v(" Search/Query in URL")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-rfc extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v('search         = *[ uchar | ";" | ":" | "@" | "&" | "=" ]\nuchar          = unreserved | escape\nunreserved     = alpha | digit | safe | extra\nalpha          = lowalpha | hialpha\nlowalpha       = "a" | "b" | "c" | "d" | "e" | "f" | "g" | "h" |\n                 "i" | "j" | "k" | "l" | "m" | "n" | "o" | "p" |\n                 "q" | "r" | "s" | "t" | "u" | "v" | "w" | "x" |\n                 "y" | "z"\nhialpha        = "A" | "B" | "C" | "D" | "E" | "F" | "G" | "H" | "I" |\n                 "J" | "K" | "L" | "M" | "N" | "O" | "P" | "Q" | "R" |\n                 "S" | "T" | "U" | "V" | "W" | "X" | "Y" | "Z"\ndigit          = "0" | "1" | "2" | "3" | "4" | "5" | "6" | "7" |\n                 "8" | "9"\nsafe           = "$" | "-" | "_" | "." | "+"\nextra          = "!" | "*" | "\'" | "(" | ")" | ","\nescape         = "%" hex hex\nhex            = digit | "A" | "B" | "C" | "D" | "E" | "F" |\n                 "a" | "b" | "c" | "d" | "e" | "f"\n')])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ul",[s("li",[s("code",[t._v("?")]),t._v(" as the start of a search/query.")]),s("li",[t._v("Identifier before "),s("code",[t._v("=")]),t._v(" is used as search key.")]),s("li",[t._v("Identifier after "),s("code",[t._v("=")]),t._v(" is used as search value.")]),s("li",[t._v("Search items use "),s("code",[t._v("&")]),t._v(" as delimiter.")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"run-module-method"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#run-module-method","aria-hidden":"true"}},[this._v("#")]),this._v(" Run() Module Method")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"serverhub-run"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#serverhub-run","aria-hidden":"true"}},[this._v("#")]),this._v(" ServerHub.Run()")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"instance-run-configuration"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#instance-run-configuration","aria-hidden":"true"}},[this._v("#")]),this._v(" Instance.Run() Configuration")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("The other day, I introduced "),e("code",[this._v("instance.Run()")]),this._v(" method to you. And in this chapter, we will talk about the first parameter of "),e("code",[this._v("instance.Run()")]),this._v(" method - the configuration object.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"as-simple-as-possible"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#as-simple-as-possible","aria-hidden":"true"}},[this._v("#")]),this._v(" As simple as possible")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("code",[this._v("BaseDir")]),this._v(" is the root path of server, which will be used during the whole life circle of your ServerHub application. If your current entry file, such as "),e("code",[this._v("app.js")]),this._v(", is just located in the directory that you want to use as server root. Then the value should be "),e("code",[this._v("__dirname")]),this._v(", which is a global variable of Node.js.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"other-properties"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#other-properties","aria-hidden":"true"}},[this._v("#")]),this._v(" Other properties")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h5",{attrs:{id:"webdir"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#webdir","aria-hidden":"true"}},[this._v("#")]),this._v(" WebDir")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("code",[this._v("WebDir")]),this._v(' is website directory. Your page files, contents, scripts and assets should be put in this directory. ServerHub uses "www/" as its default value. If you want to set up a new website root directory, create a folder and pass its name to '),e("code",[this._v("WebDir")]),this._v(" property.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h5",{attrs:{id:"controllerdir"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#controllerdir","aria-hidden":"true"}},[this._v("#")]),this._v(" ControllerDir")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h5",{attrs:{id:"controllers-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#controllers-2","aria-hidden":"true"}},[this._v("#")]),this._v(" Controllers")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Sometimes, we don't want to register every controller in the contain folder. Then we can pass an array of required controller file name to this parameter. eg: "),e("code",[this._v("['home.js', 'data.js']")]),this._v(". But if you want all controller files to be registered, just ignore "),e("code",[this._v("Controllers")]),this._v(" property and ServerHub will automatically scan and register every file under "),e("code",[this._v("ControllerDir")]),this._v(".")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h5",{attrs:{id:"viewdir-and-modeldir"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#viewdir-and-modeldir","aria-hidden":"true"}},[this._v("#")]),this._v(" ViewDir and ModelDir")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Pretty similar to "),e("code",[this._v("ControllerDir")]),this._v(" in previous section. They are used to hold view files and models.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h5",{attrs:{id:"dbprovider"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#dbprovider","aria-hidden":"true"}},[this._v("#")]),this._v(" DBProvider")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h5",{attrs:{id:"dbconnectionstring"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#dbconnectionstring","aria-hidden":"true"}},[this._v("#")]),this._v(" DBConnectionString")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("If you have only one database instance to connect, the suggested way is to pass a global database connection string to ServerHub. Because if you don't, you will have to provide a value every time you call "),e("code",[this._v("GetConnection()")]),this._v(" method on your database provider.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h5",{attrs:{id:"maxcachesize"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#maxcachesize","aria-hidden":"true"}},[this._v("#")]),this._v(" MaxCacheSize")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h5",{attrs:{id:"defaultpages"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#defaultpages","aria-hidden":"true"}},[this._v("#")]),this._v(" DefaultPages")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("ServerHub uses a fallback strategy for default pages. And your default page file must be put under the root of "),e("code",[this._v("WebDir")]),this._v(' directory. In default, ServerHub uses "index.html" first, then "default.html" and finally "page.html". You can override this configuration by passing an array like '),e("code",[this._v("['hello.html', 'first.html']")]),this._v(" to this property.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h5",{attrs:{id:"pagenotfound-v0-0-93"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#pagenotfound-v0-0-93","aria-hidden":"true"}},[this._v("#")]),this._v(" PageNotFound "),e("code",[this._v("v0.0.93+")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h5",{attrs:{id:"asyncoperationtimeout-v0-0-97"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#asyncoperationtimeout-v0-0-97","aria-hidden":"true"}},[this._v("#")]),this._v(" AsyncOperationTimeout "),e("code",[this._v("v0.0.97+")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",[t._v("In "),s("code",[t._v("v0.0.96")]),t._v(", we introduced "),s("code",[t._v("this.Runtime.WAIT")]),t._v(" signal to be the workaroud for some time consuming asynchronous operations, such as database query etc. But you should know this signal is pretty dangrous. What if you "),s("code",[t._v("forget")]),t._v(" to set false to it or the operation takes too much time and dead before callback? So, ServerHub has to count down as a backup operation if it cost too much time. The default value is 10 seconds. If you want it to be shorter or longer, just pass the value to the configuration parameter.(Unit: "),s("strong",[t._v("milliseconds")]),t._v(")")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h5",{attrs:{id:"tlsoption-v1-0-6"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#tlsoption-v1-0-6","aria-hidden":"true"}},[this._v("#")]),this._v(" TLSOption "),e("code",[this._v("v1.0.6+")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",[t._v("Since "),s("code",[t._v("v1.0.6")]),t._v(", ServerHub enhanced security with TLS/SSL. You may secure the connection with a "),s("code",[t._v("TLSOption")]),t._v(" property. This property has four sub-properties: "),s("code",[t._v("Key: string, Cert: string, CA: string")]),t._v("x and "),s("code",[t._v("Port: Array<string>|Array<number>|number|string")]),t._v(". You need to load your private key and certificate files and assign their values to the properties above. And most importantly, you need to specify the port you want to secure.")])}],!1,null,null,null);e.default=n.exports}}]);